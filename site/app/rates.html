<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Daily Treasury Yield Curve Rates</title>

  <script src="bower_components/jquery/jquery.js"></script>
  <script src="js/d3.min.js"></script>
  <script src="js/modernizr-latest.js"></script>

  <style type="text/css">
	.chart div {
   	font: 10px sans-serif;
   	background-color: steelblue;
   	text-align: right;
   	padding: 3px;
   	margin: 1px;
   	color: white;
 	}
  </style>
</head>
<body>
<div id="chart" class="chart"></div>
<script>
// Create the XHR object.
function createCORSRequest(method, url) {
  var xhr = new XMLHttpRequest();
  if ("withCredentials" in xhr) {
    // XHR for Chrome/Firefox/Opera/Safari.
    xhr.open(method, url, true);
  } else if (typeof XDomainRequest != "undefined") {
    // XDomainRequest for IE.
    xhr = new XDomainRequest();
    xhr.open(method, url);
  } else {
    // CORS not supported.
    xhr = null;
  }
  return xhr;
}

d3.xml("http://data.treasury.gov/feed.svc/DailyTreasuryYieldCurveRateData?$filter=month(NEW_DATE)%20eq%205%20and%20year(NEW_DATE)%20eq%202014", "application/xml")
.header("Access-Control-Allow-Origin", "http://ec2-54-83-155-47.compute-1.amazonaws.com:8000")
.get(function(xml) {

	var entry = d3.select(xml).selectAll("entry")[0];
	d3.select("#chart")
	.selectAll("div")
    	.data(entry)
    	.enter().append("div")
		.style("width", function(d) { return parseFloat(d3.select(d).select("content")[0][0].firstElementChild.childNodes[21].innerHTML) * 10 + "px"; })
		.text(function(d) { return d3.select(d).select("content")[0][0].firstElementChild.childNodes[21].innerHTML; });

});
</script>

</body>
</html>
